================================================================================
                    城市烟火气探索与智能旅行平台
                         功能说明文档 v2.0
================================================================================

【产品名称】烟火漫游

【一句话定位】
  用数据发现城市的烟火气，用AI规划独特的探索路线，记录你的城市漫游故事。

【覆盖范围】全国县级行政区（约2850个）

【产品形态】
  - 开发阶段：Web响应式（方便调试）
  - 最终形态：Web + 桌面APP + 手机APP（Electron/Capacitor封装）


================================================================================
【数据采集方案选择】⚠️ 需要讨论决定
================================================================================

我们需要采集的核心数据：POI店铺信息、评论数据、营业时间、价格等
以下提供三种方案，请讨论后选择：

┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃                        方案A：纯高德API                               ┃
┣━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┫

【数据内容】
  ✓ POI名称、地址、坐标、类型
  ✓ 营业时间（部分有）
  ✗ 评论内容（无）
  ✗ 人均价格（无）
  ✗ 评分（无）

【成本估算】
  全国采集约需：142,500次调用
  免费额度：5,000次/月
  超出费用：约 413元（一次性）
  
  或者：多账号白嫖（约需30个账号，或5个账号×6个月）

【优点】
  ✓ 数据覆盖全（小店也有）
  ✓ 坐标精准
  ✓ 官方API稳定

【缺点】
  ✗ 没有评论数据（无法分析情感、人气）
  ✗ 没有价格数据（无法分析亲民度）
  ✗ 需要付费或多账号操作

【适合场景】
  如果只需要POI分布分析，不需要评论数据

┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛


┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃                      方案B：纯大众点评爬虫                             ┃
┣━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┫

【数据内容】
  ✓ 店铺名称、地址、坐标、类型
  ✓ 评论内容（丰富）
  ✓ 人均价格
  ✓ 评分
  ✓ 营业时间
  ✓ 开业时间（可算老店）

【成本估算】
  完全免费（爬虫）
  但需要处理反爬机制

【优点】
  ✓ 数据丰富（评论、价格、评分都有）
  ✓ 完全免费
  ✓ 可以做情感分析、人气分析

【缺点】
  ✗ 小店铺可能没收录（大众点评偏向餐饮娱乐）
  ✗ 反爬机制需要处理（IP代理、验证码）
  ✗ 数据获取速度较慢

【适合场景】
  如果重点分析餐饮娱乐类烟火气，追求数据丰富度

┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛


┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃                  方案C：高德+大众点评混合（推荐）                       ┃
┣━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┫

【策略】
  1. 高德API：获取全量POI基础数据（名称、坐标、类型）
  2. 大众点评爬虫：补充评论、价格、评分数据
  3. 数据匹配：通过名称+坐标匹配两个数据源

【数据内容】
  ✓ POI完整覆盖（高德）
  ✓ 评论数据（大众点评，部分匹配）
  ✓ 价格评分（大众点评，部分匹配）

【成本估算】
  高德费用：约413元 或 多账号白嫖
  大众点评：免费

【优点】
  ✓ POI覆盖全
  ✓ 有评论数据的店铺可做深度分析
  ✓ 数据互补

【缺点】
  ✗ 需要做数据匹配（开发工作量增加）
  ✗ 部分小店可能匹配不上评论

【适合场景】
  追求数据全面性，愿意多花开发时间

┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛


【我的建议】
  
  如果时间充裕 → 方案C（混合）最佳
  如果追求速度 → 方案B（大众点评）足够用
  
  因为"烟火气"主要体现在餐饮、娱乐、夜生活这些品类，
  而这些恰好是大众点评覆盖最好的领域。
  
  五金店、修车铺这种高德有但大众点评没有的，
  其实对"烟火气"指数贡献不大。

【请讨论后告诉我你们的选择】


================================================================================
【核心功能模块设计】（根据讨论调整后）
================================================================================

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
模块一：城市烟火气分析引擎（数据底座）
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

【模块定位】
  整个平台的数据底座，负责采集、处理、分析多源城市数据，
  构建"烟火气指数"评价体系，为上层功能提供数据支撑。

【1.1 多源数据采集】

  ┌────────────────┬─────────────────────────────────────────┐
  │   数据类型     │   数据来源                               │
  ├────────────────┼─────────────────────────────────────────┤
  │ POI基础数据    │ 高德API 或 大众点评爬虫（待定）          │
  │ 评论数据       │ 大众点评爬虫                             │
  │ 价格数据       │ 大众点评爬虫                             │
  │ 夜光遥感       │ NASA NPP-VIIRS（免费下载）               │
  │ 营业时间       │ POI详情数据                              │
  └────────────────┴─────────────────────────────────────────┘

【1.2 烟火气指标体系】（调整后）

  ┌─────────────────────────────────────────────────────────────┐
  │ 一级指标          二级指标              计算方法            │
  ├─────────────────────────────────────────────────────────────┤
  │                   餐饮密度              每km²餐饮POI数       │
  │ 业态丰富度(25%)   业态多样性            Shannon多样性指数    │
  │                   本地特色占比          规则识别（人工标注） │
  ├─────────────────────────────────────────────────────────────┤
  │                   夜间营业比例          晚8点后营业店铺占比  │
  │ 夜间活力(25%)     深夜营业比例          凌晨仍营业店铺占比   │
  │                   夜光强度              NASA VIIRS灯光值     │
  ├─────────────────────────────────────────────────────────────┤
  │                   评论总量              店铺评论数加总       │
  │ 人气热度(25%)     近期活跃度            近3月新增评论数      │
  │                   评论情感倾向          NLP情感分析正面比例  │
  ├─────────────────────────────────────────────────────────────┤
  │                   价格亲民度            人均消费中位数       │
  │ 生活气息(25%)     老店比例              开业3年以上占比      │
  │                   本地特色占比          规则识别             │
  └─────────────────────────────────────────────────────────────┘

【1.3 本地特色店铺识别】（人工标注+规则学习）

  步骤：
  1. 先采集3-5个县的样本数据
  2. 人工标注"本地特色"店铺（给你们Excel表格打勾）
  3. 我分析标注数据，提取识别规则：
     - 店名关键词（"老"、"记"、地名、方言词）
     - 品类特征（小吃、早餐、本地菜）
     - 评论关键词（"正宗"、"老店"、"本地人推荐"）
  4. 用规则自动识别全国数据

【1.4 空间分析】

  - 网格划分：将城市划分为500m×500m网格单元
  - 指标计算：计算每个网格的各项烟火气指标
  - 综合评分：加权计算烟火气综合指数（0-100分）
  - 热点识别：Getis-Ord Gi*识别高活力热点区域
  - 街区聚类：K-Means识别街区类型（美食型/夜生活型/文艺型...）

【技术实现】
  - 数据存储：PostgreSQL + PostGIS
  - 空间分析：Python GeoPandas + PySAL
  - 遥感处理：Rasterio
  - NLP情感分析：SnowNLP 或 通义千问API
  - 定时任务：Celery


━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
模块二：城市烟火气地图（核心展示）
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

【2.1 烟火气热力图】
  - 全国视图：省→市→县逐级下钻
  - 颜色映射：烟火气指数 → 蓝(低)→黄→红(高)
  - 图层切换：综合/业态/夜间/人气/生活气息

【2.2 夜光视图模式】🌙 新增亮点
  - NASA夜光遥感数据作为底图
  - 展示城市夜间灯光分布
  - 视觉效果震撼（答辩加分）
  - 可叠加烟火气热力图

【2.3 街区详情卡片】
  点击区域显示：
  ├── 烟火气综合评分（大字）
  ├── 四维雷达图
  ├── 代表性店铺TOP5
  ├── 用户评价精选
  ├── 最佳探索时段
  └── "开始探索"按钮

【2.4 时间维度切换】
  - 时间滑块：早/中/晚/深夜
  - 动画播放：一天活力变化动画
  - 最佳时段提示

【2.5 城市发展趋势】🌙 夜光数据应用
  - 对比2015/2020/2024年夜光数据
  - 识别"正在崛起"和"正在衰落"的街区
  - 趋势变化可视化

【2.6 筛选与发现】
  - 类型筛选：美食/夜生活/文艺/综合
  - 距离筛选：周边N公里
  - 排行榜：全国/省/市烟火气TOP榜
  - 冷门宝藏：高烟火气+低知名度

【2.7 对比功能】
  - 街区对比：2-3个街区多维对比
  - 城市对比：不同城市烟火气PK

【技术实现】
  - 地图引擎：Mapbox GL JS（支持夜光底图）
  - 可视化：Deck.gl + ECharts
  - 前端框架：Vue 3 + TailwindCSS


━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
模块三：智能探索路线规划
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

【3.1 智能路线生成】
  
  输入条件：
  ├── 所在城市/当前位置
  ├── 可用时间（2小时/半天/一天）
  ├── 探索偏好（美食/文艺/夜生活/综合）
  ├── 体力程度（休闲/暴走）
  └── 预算范围（可选）

  输出结果：
  ├── 推荐探索点位（基于烟火气筛选）
  ├── 优化游览顺序（TSP最短路径）
  ├── 每个点位建议停留时长
  ├── 步行/公交/骑行方案
  └── 总预算估算

【3.2 主题路线模板】
  🍜 深夜觅食路线 - 高夜间活力美食街区
  📚 文艺漫步路线 - 咖啡馆/书店/艺术空间
  🌃 夜游路线 - 基于夜光数据的夜间探索
  🏠 老城烟火路线 - 老店/传统市场
  📷 小众出片路线 - 高颜值低知名度
  🎲 随机惊喜路线 - 随机生成

【3.3 路线详情】
  - 地图路线可视化
  - 每个点位：名称/评分/推荐理由/最佳时段/人均消费
  - 点击跳转高德/百度导航

【3.4 路线调整】
  - 手动增删点位
  - 拖拽调整顺序
  - 重新优化路径
  - 保存到"我的路线"

【技术实现】
  - 路径优化：OR-Tools / 自实现TSP
  - 导航API：高德路径规划（免费额度15万次/月，够用）


━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
模块四：探索记录与足迹
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

【4.1 探索打卡】
  - GPS到达检测，提示打卡
  - 拍照打卡，自动关联地点
  - 快捷评价：值得来/一般/踩雷
  - 一句话感受

【4.2 足迹地图】
  - 个人打卡点位地图
  - 足迹统计：城市数/点位数/里程/时长
  - 足迹热力图
  - 按时间线浏览

【4.3 探索日记】
  - 每日探索自动聚合
  - 照片按地点整理
  - 消费记录

【4.4 轨迹回放】
  - 地图回放某次探索路线
  - 照片定位展示


━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
模块五：AI游记生成
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

【5.1 素材整合】
  自动收集：照片、路线、点位信息、心情记录、消费

【5.2 AI游记生成】
  - 一键生成图文游记
  - 风格选择：
    📝 实用攻略风
    🎨 文艺小清新
    😄 轻松幽默风

【5.3 游记编辑】
  - 可视化编辑器
  - AI重写段落
  - 配图调整

【5.4 导出分享】
  - 长图导出（朋友圈/微博）
  - 小红书格式
  - 链接分享

【技术实现】
  - AI生成：通义千问API
  - 长图生成：html2canvas


━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
模块六：探索社区
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

【6.1 游记广场】
  - 瀑布流浏览
  - 按城市/主题筛选
  - 热门推荐

【6.2 路线分享】
  - 路线广场
  - 一键复制路线
  - 路线评价

【6.3 隐藏点位贡献】
  - 用户发现新宝藏点位
  - 社区验证
  - 贡献积分

【6.4 互动】
  - 点赞/收藏/评论
  - 用户关注


================================================================================
【技术架构总览】
================================================================================

┌─────────────────────────────────────────────────────────────────────────┐
│                              前端层                                      │
│  Vue 3 + Mapbox GL + Deck.gl + ECharts + TailwindCSS + Pinia            │
└─────────────────────────────────────────────────────────────────────────┘
                                    │
                                    ▼
┌─────────────────────────────────────────────────────────────────────────┐
│                              后端层                                      │
│                         Python FastAPI                                   │
│  用户模块 | 烟火气分析 | 路线规划 | 足迹记录 | 游记生成 | 社区模块       │
└─────────────────────────────────────────────────────────────────────────┘
                                    │
                                    ▼
┌─────────────────────────────────────────────────────────────────────────┐
│                              数据层                                      │
│  PostgreSQL + PostGIS | Redis | Elasticsearch                           │
└─────────────────────────────────────────────────────────────────────────┘
                                    │
                                    ▼
┌─────────────────────────────────────────────────────────────────────────┐
│                           AI/分析层                                      │
│  通义千问API | GeoPandas | PySAL | OR-Tools | Rasterio | SnowNLP        │
└─────────────────────────────────────────────────────────────────────────┘


================================================================================
【夜光遥感数据应用汇总】🌙
================================================================================

确保NASA夜光数据充分利用：

1. 【烟火气指标】夜间活力维度 - 夜光强度作为指标之一
2. 【地图展示】夜光视图模式 - 夜光数据作为酷炫底图
3. 【趋势分析】城市发展趋势 - 多年夜光对比识别变化
4. 【路线规划】夜游路线 - 基于夜光数据推荐夜间探索
5. 【可视化】3D夜光城市 - 答辩展示用（可选）


================================================================================
【开发计划】
================================================================================

【第一阶段：数据底座】2周
  □ 数据采集方案确定并实施
  □ 夜光遥感数据处理
  □ 本地特色标注与规则学习
  □ 烟火气指标计算
  □ 数据库设计搭建

【第二阶段：核心展示】3周
  □ 烟火气地图（含夜光视图）
  □ 智能路线规划
  □ 用户系统

【第三阶段：记录分享】2周
  □ 探索打卡与足迹
  □ AI游记生成
  □ 社区基础功能

【第四阶段：完善封装】1周
  □ UI美化
  □ 性能优化
  □ APP封装（Electron + Capacitor）
  □ 答辩材料


================================================================================
【待讨论确认事项】
================================================================================

1. 数据采集方案选择：A/B/C 哪个？

2. 首批标注数据：选哪几个县作为样本？
   建议：武汉市的几个区（你们熟悉）

3. 其他问题？


================================================================================
                        等待你们讨论后反馈！
================================================================================
