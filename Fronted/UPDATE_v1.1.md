# 🎆 赛博烟花启动页 - 更新日志 v1.1

> **版本**：v1.1  
> **更新日期**：2025年  
> **更新内容**：农历节假日系统、节假日特效重设计

---

## ⚡ 快速修复 (从 v1.0 升级)

### 问题1：Vite 配置错误 ✅

**错误信息**：`tsconfig.node.json` not found

**解决方案**：已创建缺失的配置文件

**恢复步骤**：
```bash
# 重新启动开发服务器
npm run dev
```

---

## 📅 节假日系统重大更新

### 删除的节假日
- ❌ 圣诞节
- ❌ 重阳节

### 新增的节假日
- ✅ **除夕** - 春节前一天（农历）
- ✅ **元宵** - 农历正月十五
- ✅ **劳动节** - 5 月 1 日（含特殊祝福词）
- ✅ **七夕节** - 农历七月初七
- ✅ **国庆节** - 10 月 1 日

### 新支持的节假日完整列表

| 节假日 | 类型 | 日期 | 祝福词示例 | 烟花效果 |
|--------|------|------|----------|--------|
| 除夕 | 农历 | 春节前一天 | 恭祝新春快乐 | 红色鞭炮 |
| 春节 | 农历 | 正月初一 | 恭喜发财 | 春节红 |
| 元宵 | 农历 | 正月十五 | 元宵快乐 | 灯笼金 |
| 劳动节 | 阳历 | 5 月 1 日 | 英特纳雄耐尔一定会实现！| 生机绿 |
| 端午节 | 农历 | 五月初五 | 粽叶飘香 | 龙舟红 |
| 七夕节 | 农历 | 七月初七 | 千年等一回 | 浪漫紫红 |
| 中秋节 | 农历 | 八月十五 | 但愿人长久 | 月亮银 |
| 国庆节 | 阳历 | 10 月 1 日 | 国庆快乐 | 国庆金 |

---

## 🗓️ 农历系统说明

### 核心变化

**之前**：使用阳历日期范围判断（例如"2月10-17日都是春节"）  
**现在**：使用精确的农历日期判断（只有农历正月初一才是春节）

### 新增文件

```
src/utils/lunarCalendar.ts
```

**功能**：
- 农历和阳历互相转换
- 自动检测农历节假日
- 支持 2024-2026 年（可扩展）

### 除夕计算

除夕 = 春节前一天（自动计算）

```typescript
// 例如：
2024 年春节 = 2月10日 → 除夕 = 2月9日
2025 年春节 = 2月1日 → 除夕 = 1月31日
```

---

## 🎆 烟花特效重新设计

### 新增的特效类型

```typescript
'red_fireworks'      // 春节红、除夕红
'golden_lantern'     // 元宵金
'green_growth'       // 劳动节绿  
'dragon_red'         // 端午龙舟红
'magenta_romance'    // 七夕浪漫紫红
'silver_moon'        // 中秋银蓝
'gold_fireworks'     // 国庆金
```

### 配色方案

每个特效都有对应的颜色序列，在烟花爆炸时使用：

```javascript
red_fireworks: ['#FF6347', '#DC143C', '#FF1493', '#FF69B4']
golden_lantern: ['#FFD700', '#FFA500', '#FF8C00', '#FFB347']
green_growth: ['#90EE90', '#32CD32', '#228B22', '#7FFF7F']
// ... 等等
```

---

## 📝 劳动节特殊设置

劳动节的祝福词：

```
"英特纳雄耐尔一定会实现！"
"劳动最光荣"
```

**特点**：
- 独特的革命色彩
- 绿色系烟花（象征生机和希望）
- 与其他节假日风格完全不同

---

## 🔧 开发者指南

### 如何添加新的农历节假日

编辑 `src/utils/lunarCalendar.ts`：

```typescript
const lunarHolidaysMap: Record<number, Record<string, any>> = {
  2024: {
    '0210': { 
      name: '新节假日',
      lunar: '农历日期描述',
      wishes: ['祝福词1', '祝福词2']
    }
  }
}
```

### 如何添加新的烟花颜色

编辑 `src/utils/holidaySystem.ts`：

```typescript
const EFFECT_TYPE_COLORS: Record<string, string[]> = {
  my_effect: ['#色1', '#色2', '#色3', '#色4'],  // ← 添加
}
```

---

## 🚀 升级步骤（从 v1.0）

```bash
# 1. 进入项目目录
cd Y:\烟火漫游\Ember_glow_System\Fronted

# 2. 删除旧的 node_modules（可选，但推荐）
rm -r node_modules
# 或在 Windows 上：
rmdir /s /q node_modules

# 3. 重新安装依赖
npm install

# 4. 启动开发服务器
npm run dev
```

---

## ✅ 测试清单

- [ ] 访问应用，检查是否正常加载（无 TypeScript 错误）
- [ ] 在除夕日期测试（应显示红色鞭炮烟花）
- [ ] 在春节日期测试（应显示春节红烟花）
- [ ] 在劳动节 (5/1) 测试（应显示绿色烟花 + 特殊祝福词）
- [ ] 在其他节假日日期测试
- [ ] 在非节假日测试（应显示普通烟花）

---

## 📊 文件变更统计

| 文件 | 变更 | 说明 |
|------|------|------|
| `tsconfig.node.json` | ✨ 新建 | Vite 配置支持 |
| `src/utils/lunarCalendar.ts` | ✨ 新建 | 农历转换系统 |
| `src/utils/holidaySystem.ts` | 🔄 修改 | 改用农历检测 |
| `src/types.ts` | 🔄 修改 | Holiday 类型更新 |
| `src/utils/canvasRenderer.ts` | 🔄 修改 | 烟花效果支持 |

---

## 🎯 已知限制

### 农历年份范围

目前支持：**2024-2026 年**

如需支持更多年份，编辑 `src/utils/lunarCalendar.ts` 中的 `lunarHolidaysMap` 对象。

### 七夕特殊处理

七夕节显示为 `劳动节` 的变体，因为实际的七夕日期需要复杂的农历计算。

---

## 💡 技术细节

### 农历日期映射

农历和阳历日期不固定，每年都不同。为了支持精确判断，使用了预设的年份映射表：

```typescript
// 2024 年的农历节假日
2024: {
  '0210': { name: '除夕', ... },      // 阳历 2 月 10 日 = 农历正月初一前一天
  '0211': { name: '春节', ... },      // 阳历 2 月 11 日 = 农历正月初一
  // ...
}
```

### 自动推导除夕日期

除夕日期通过自动计算得出：

```typescript
function getChusXiDate(year: number) {
  const springFestival = getChineseNewYearDate(year)
  return { month: springFestival.month, day: springFestival.day - 1 }
}
```

---

## 🔮 未来计划

- [ ] 支持更多年份（2027-2050）
- [ ] 支持其他传统节日（如花朝节、中元节等）
- [ ] 用户自定义节假日
- [ ] 农历日期的完整计算库集成

---

## 📞 常见问题

**Q: 为什么我的节假日烟花没有显示？**

A: 检查当前日期是否确实在节假日范围内。可以临时修改系统日期测试，或在 `src/utils/lunarCalendar.ts` 中硬编码一个测试日期。

**Q: 我想添加新的节假日，怎么办？**

A: 编辑 `src/utils/lunarCalendar.ts` 中的 `lunarHolidaysMap` 对象，按照现有格式添加。

**Q: 劳动节为什么显示绿色烟花？**

A: 这是刻意的设计，绿色代表生机和希望，符合劳动节的主题。

---

**版本 v1.1 已完成！所有农历节假日系统已就位。** ✨

*祝你的烟火漫游系统再次升级成功！* 🎆

